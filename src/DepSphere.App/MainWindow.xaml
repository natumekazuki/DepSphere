<Window x:Class="DepSphere.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        Title="DepSphere Host" Height="920" Width="1560"
        MinHeight="720" MinWidth="1200"
        Background="{StaticResource BrushSurface}">
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="56" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <Border Grid.Row="0" Background="#0B1220" BorderBrush="#1E293B" BorderThickness="0,0,0,1">
      <Grid Margin="16,8,16,8">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
          <TextBlock Text="DepSphere" FontSize="18" FontWeight="SemiBold" />
          <TextBlock Text="  /  WPF Host Preview" FontSize="13" Foreground="{StaticResource BrushMuted}" VerticalAlignment="Bottom" Margin="8,0,0,1" />
        </StackPanel>
        <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
          <Button x:Name="ToggleOperationsPanelButton" Content="操作パネルを隠す" Click="OnToggleOperationsPanelClick" />
          <Button x:Name="LoadSampleButton" Content="サンプル読込" Click="OnLoadSampleClick" />
          <Button x:Name="ReloadButton" Content="再解析" Click="OnReloadClick" />
          <Button x:Name="CancelButton" Content="キャンセル" Click="OnCancelClick" IsEnabled="False" Style="{StaticResource DangerButtonStyle}" />
        </StackPanel>
      </Grid>
    </Border>

    <Grid Grid.Row="1" Margin="14">
      <Grid.ColumnDefinitions>
        <ColumnDefinition x:Name="LeftPanelColumn" Width="280" MinWidth="0" />
        <ColumnDefinition x:Name="LeftSplitterColumn" Width="6" />
        <ColumnDefinition x:Name="GraphPanelColumn" Width="*" MinWidth="340" />
        <ColumnDefinition x:Name="GraphCodeSplitterColumn" Width="6" />
        <ColumnDefinition x:Name="CodePanelColumn" Width="420" MinWidth="280" />
      </Grid.ColumnDefinitions>

      <Border x:Name="OperationsPanelBorder" Grid.Column="0" Background="{StaticResource BrushPanel}" CornerRadius="14" Padding="14" BorderBrush="#1E293B" BorderThickness="1">
        <StackPanel>
          <TextBlock Text="操作" FontSize="15" FontWeight="SemiBold" />
          <TextBlock Margin="0,8,0,0" Foreground="{StaticResource BrushMuted}" Text="ノードをクリックすると右ペインにコードが表示されます。" TextWrapping="Wrap" />

          <Separator Margin="0,14,0,14" />

          <TextBlock Text="解析対象" FontWeight="SemiBold" />
          <TextBox x:Name="ProjectPathTextBox" Margin="0,6,0,0" TextWrapping="Wrap" />
          <TextBlock Margin="0,10,0,0" Text="進捗更新間隔（型件数）" FontWeight="SemiBold" />
          <TextBox x:Name="ProgressIntervalTextBox" Margin="0,6,0,0" Text="25" />
          <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
            <Button x:Name="BrowseProjectButton" Content="参照" Click="OnBrowseProjectClick" />
            <Button x:Name="AnalyzeButton" Content="解析実行" Click="OnAnalyzeClick" />
          </StackPanel>

          <Separator Margin="0,14,0,14" />

          <TextBlock Text="選択ノード" FontWeight="SemiBold" />
          <TextBlock x:Name="SelectedNodeText" Margin="0,6,0,0" Text="(未選択)" TextWrapping="Wrap" />
          <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
            <Button x:Name="CodeHistoryBackButton" Content="コード戻る" Click="OnCodeHistoryBackClick" IsEnabled="False" />
            <Button x:Name="CodeHistoryForwardButton" Content="コード進む" Click="OnCodeHistoryForwardClick" IsEnabled="False" />
          </StackPanel>

          <Separator Margin="0,14,0,14" />

          <TextBlock Text="状態" FontWeight="SemiBold" />
          <TextBlock x:Name="StatusText" Margin="0,6,0,0" Foreground="{StaticResource BrushMuted}" Text="初期化待ち" TextWrapping="Wrap" />
          <Button x:Name="CopyErrorButton" Margin="0,8,0,0" Content="エラー詳細をコピー" Click="OnCopyErrorClick" IsEnabled="False" />
          <TextBox x:Name="ErrorDetailsTextBox"
                   Margin="0,8,0,0"
                   Height="120"
                   TextWrapping="Wrap"
                   AcceptsReturn="True"
                   VerticalScrollBarVisibility="Auto"
                   IsReadOnly="True"
                   Visibility="Collapsed" />
        </StackPanel>
      </Border>

      <GridSplitter x:Name="LeftPanelSplitter"
                    Grid.Column="1"
                    Width="6"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    ResizeBehavior="PreviousAndNext"
                    ResizeDirection="Columns"
                    Background="#1E293B"
                    ShowsPreview="True" />

      <Border Grid.Column="2" Background="#020617" CornerRadius="14" BorderBrush="#1E293B" BorderThickness="1" ClipToBounds="True">
        <wv2:WebView2 x:Name="GraphWebView" />
      </Border>

      <GridSplitter x:Name="GraphCodeSplitter"
                    Grid.Column="3"
                    Width="6"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    ResizeBehavior="PreviousAndNext"
                    ResizeDirection="Columns"
                    Background="#1E293B"
                    ShowsPreview="True" />

      <Border Grid.Column="4" Background="#020617" CornerRadius="14" BorderBrush="#1E293B" BorderThickness="1" ClipToBounds="True">
        <wv2:WebView2 x:Name="CodeWebView" />
      </Border>
    </Grid>
  </Grid>
</Window>
